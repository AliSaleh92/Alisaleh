<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ali Workspace - Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø´Ø§Ù…Ù„</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            margin: 0; padding: 0; box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f7fa;
        }
        .sidebar {
            position: fixed; right: 0; top: 0; width: 250px; height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff; padding: 32px 16px; box-shadow: -2px 0 15px #667eea21;
            z-index: 200;
        }
        .logo { text-align: center; margin-bottom: 32px; font-size: 1.7em; font-weight: bold; }
        .menu { list-style: none; padding: 0; }
        .menu-item { padding: 16px 20px; border-radius: 8px; margin-bottom: 8px; cursor: pointer; font-size: 1.05em; transition: background 0.15s;}
        .menu-item.active, .menu-item:hover { background:rgba(255,255,255,.15); }
        .main-content { margin-right: 250px; padding: 32px 18px; min-height: 100vh;}
        .header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 18px;}
        .header h2 {margin: 0; font-size:2.2em;color:#667eea;}
        .section {display:none;}
        .section.active {display:block; animation:fadeIn .4s;}
        @keyframes fadeIn {from{opacity:0;} to{opacity:1;}}
        .add-btn { padding:9px 18px; font-size:1em; background:linear-gradient(135deg, #667eea 0%, #764ba2 100%); color:#fff; border:none; border-radius:18px; cursor:pointer; margin-bottom:15px;}
        /* Dashboard Stats */
        .stats {display: flex; gap: 20px; flex-wrap: wrap; margin-bottom:32px;}
        .stat { background:#fff; border-radius:14px; padding:18px; box-shadow:0 3px 15px #667eea11; width:170px; text-align:center;}
        .stat-val { font-size:2em; margin:8px 0; color:#764ba2;}
        /* Projects */
        .proj-grid {display:grid; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); gap:19px;}
        .proj-card { background:#fff; border-radius:14px; padding:18px 14px; box-shadow:0 3px 15px #667eea12;}
        .proj-title { font-size:1.12em; font-weight:bold; margin-bottom:8px; }
        .proj-actions { display:flex; gap:9px; }
        /* Tasks */
        .task-grid { background:#fff; border-radius:14px; padding:16px; box-shadow:0 3px 15px #667eea14;}
        .task-head {display:flex;align-items:center; justify-content:space-between;}
        .task-list {margin-top:12px;}
        .task-item {background:#f7f7fc; margin-bottom:8px;padding:12px; border-radius:10px; display:flex;align-items:center; justify-content:space-between;}
        .task-done { text-decoration:line-through; color:#888;}
        /* Calendar */
        .calendar-nav {display:flex;align-items:center;gap:8px;margin-bottom:8px;}
        .calendar-days {display:grid;grid-template-columns:repeat(7,1fr);gap:6px;}
        .day-cell {text-align:center;padding:9px 3px;background:#fff;border-radius:7px;border:1px solid #eee;}
        .day-cell.today { background:#667eea;color:#fff;font-weight:bold;}
        /* Notes */
        .notes-head {display:flex;align-items:center;justify-content:space-between;}
        .note-grid {display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:15px;margin-top:18px;}
        .note-card {background:#fff;border-radius:13px;padding:15px;box-shadow:0 3px 15px #667eea12;}
        .note-title {font-weight:bold;margin-bottom:7px;}
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="logo">Ali Workspace</div>
        <ul class="menu">
            <li class="menu-item active" onclick="showSection('dashboard')">ğŸ“Š Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</li>
            <li class="menu-item" onclick="showSection('projects')">ğŸ“ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</li>
            <li class="menu-item" onclick="showSection('tasks')">âœ… Ø§Ù„Ù…Ù‡Ø§Ù…</li>
            <li class="menu-item" onclick="showSection('calendar')">ğŸ“… Ø§Ù„ØªÙ‚ÙˆÙŠÙ…</li>
            <li class="menu-item" onclick="showSection('notes')">ğŸ“ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</li>
        </ul>
    </div>
    <div class="main-content">
        <!-- Dashboard Section -->
        <div id="dashboard" class="section active">
            <div class="header"><h2>ğŸ“Š Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¡Ø§Øª</h2></div>
            <div class="stats">
                <div class="stat"><div>Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</div><div class="stat-val" id="statProjects">0</div></div>
                <div class="stat"><div>Ø§Ù„Ù…Ù‡Ø§Ù…</div><div class="stat-val" id="statTasks">0</div></div>
                <div class="stat"><div>Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©</div><div class="stat-val" id="statDone">0</div></div>
            </div>
            <canvas id="chartTasks" height="85"></canvas>
        </div>
        <!-- Projects Section -->
        <div id="projects" class="section">
            <div class="header">
                <h2>ğŸ“ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</h2>
                <button class="add-btn" onclick="addProjectPrompt()">+ Ø¥Ø¶Ø§ÙØ© Ù…Ø´Ø±ÙˆØ¹</button>
            </div>
            <div class="proj-grid" id="projGrid"></div>
        </div>
        <!-- Tasks Section -->
        <div id="tasks" class="section">
            <div class="header">
                <h2>âœ… Ø§Ù„Ù…Ù‡Ø§Ù…</h2>
                <button class="add-btn" onclick="addTaskPrompt()">+ Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø©</button>
            </div>
            <div class="task-grid">
                <div class="task-head">
                    <select id="tasksProjSelect" onchange="renderTasks()"></select>
                    <span><input type="checkbox" id="showDoneChk" onchange="renderTasks()"> Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©</span>
                </div>
                <div class="task-list" id="taskList"></div>
            </div>
        </div>
        <!-- Calendar Section -->
        <div id="calendar" class="section">
            <div class="header">
                <h2>ğŸ“… Ø§Ù„ØªÙ‚ÙˆÙŠÙ…</h2>
            </div>
            <div class="calendar-nav">
                <button onclick="moveMonth(-1)">âŸ¨</button>
                <span id="calendarMonthYear"></span>
                <button onclick="moveMonth(1)">âŸ©</button>
            </div>
            <div class="calendar-days" id="calendarDays"></div>
            <div style="margin-top:16px">
                <ul id="calendarDayTasks"></ul>
            </div>
        </div>
        <!-- Notes Section -->
        <div id="notes" class="section">
            <div class="header notes-head">
                <h2>ğŸ“ Ø¯ÙØªØ± Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</h2>
                <button class="add-btn" onclick="addNotePrompt()">+ Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ø§Ø­Ø¸Ø©</button>
            </div>
            <div class="note-grid" id="noteGrid"></div>
        </div>
    </div>
    <script>
        // ------ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ© ------
        let projects = JSON.parse(localStorage.getItem("aw_projects")||"[]");
        let tasks = JSON.parse(localStorage.getItem("aw_tasks")||"[]");
        let notes = JSON.parse(localStorage.getItem("aw_notes")||"[]");
        // ------ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ÙˆØ§Ù„ØªÙ†Ù‚Ù„ ------
        function showSection(sec) {
            document.querySelectorAll('.menu-item').forEach(e=>e.classList.remove('active'));
            document.querySelectorAll('.section').forEach(e=>e.classList.remove('active'));
            document.querySelector('.menu-item[onclick*="' + sec + '"]').classList.add('active');
            document.getElementById(sec).classList.add('active');
            if(sec==="dashboard") renderDashboard();
            if(sec==="projects") renderProjects();
            if(sec==="tasks") renderTasks();
            if(sec==="calendar") renderCalendar();
            if(sec==="notes") renderNotes();
        }
        // ------ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ ------
        function addProjectPrompt() {
            let name=prompt("Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ØŸ"); if(!name) return;
            let desc=prompt("ÙˆØµÙ/Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù„Ù„Ù…Ø´Ø±ÙˆØ¹ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)");
            let id=Date.now(); projects.push({id,name,desc});
            localStorage.setItem("aw_projects",JSON.stringify(projects));
            renderProjects(); renderDashboard();
            alert("ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹âœ…");
        }
        function renderProjects() {
            let container=document.getElementById("projGrid");
            if(!projects.length) { container.innerHTML = "<p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø´Ø§Ø±ÙŠØ¹ Ø¨Ø¹Ø¯.</p>"; return; }
            container.innerHTML = projects.map(proj =>
                `<div class="proj-card">
                    <div class="proj-title">${proj.name}</div>
                    <div style="color:#888;margin-bottom:8px">${proj.desc||""}</div>
                    <div style="font-size:.9em;color:#555;margin-bottom:4px">
                        ${tasks.filter(t=>t.projectId==proj.id).length} Ù…Ù‡Ø§Ù…
                    </div>
                    <div class="proj-actions">
                        <button onclick="delProject(${proj.id})" style="color:#d66">Ø­Ø°Ù</button>
                    </div>
                </div>`
            ).join("");
        }
        function delProject(id) {
            if(!confirm("Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙˆÙƒÙ„ Ù…Ù‡Ø§Ù…Ù‡ØŸ")) return;
            projects=projects.filter(p=>p.id!=id);
            tasks=tasks.filter(t=>t.projectId!=id);
            localStorage.setItem("aw_projects",JSON.stringify(projects));
            localStorage.setItem("aw_tasks",JSON.stringify(tasks));
            renderProjects(); renderTasks(); renderDashboard();
        }
        // ------ Ø§Ù„Ù…Ù‡Ø§Ù… ------
        function addTaskPrompt() {
            if(!projects.length) return alert("Ø£Ø¶Ù Ù…Ø´Ø±ÙˆØ¹ Ø£ÙˆÙ„Ø§Ù‹!");
            let pId=+prompt("Ø±Ù‚Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù„Ø£Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù‡Ù…Ø©:\n"+projects.map(p=>`${p.id}: ${p.name}`).join("\n"));
            if(!projects.find(p=>p.id==pId)) return alert("Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ØºÙŠØ± ØµØ­ÙŠØ­");
            let txt=prompt("ÙˆØµÙ Ø§Ù„Ù…Ù‡Ù…Ø©ØŸ"); if(!txt) return;
            let date=prompt("ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø³ØªØ­Ù‚Ø§Ù‚ØŸ (yyyy-mm-dd) Ø§Ø®ØªÙŠØ§Ø±ÙŠ","");
            let done=false;
            let id=Date.now();
            tasks.push({id,projectId:pId,text:txt,date,done});
            localStorage.setItem("aw_tasks",JSON.stringify(tasks));
            renderTasks(); renderDashboard();
            alert("ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù‡Ù…Ø©âœ…");
        }
        function renderTasks() {
            let select=document.getElementById("tasksProjSelect");
            select.innerHTML=projects.map(p=>`<option value="${p.id}">${p.name}</option>`).join("");
            let showDone=document.getElementById("showDoneChk").checked;
            let currentProj=+select.value||(projects[0]?projects[0].id:0);
            let list=document.getElementById("taskList");
            let filtered=tasks.filter(t=>t.projectId==currentProj && (showDone||!t.done));
            if(!filtered.length) { list.innerHTML="<p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ø­Ø§Ù„ÙŠØ§Ù‹.</p>"; return;}
            list.innerHTML=filtered.map(t=>
                `<div class="task-item ${t.done?'task-done':''}">
                    <span style="flex:1">${t.text}${t.date?' - <span style="font-size:.9em;color:#764ba2">['+t.date+']</span>':''}</span>
                    <button onclick="toggleTask(${t.id})">${t.done?'â':'âœ”ï¸'}</button>
                    <button onclick="delTask(${t.id})" style="color:#d66">Ø­Ø°Ù</button>
                </div>`
            ).join("");
        }
        function delTask(id) {
            if(!confirm("Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù…Ù‡Ù…Ø©ØŸ")) return;
            tasks=tasks.filter(t=>t.id!=id);
            localStorage.setItem("aw_tasks",JSON.stringify(tasks));
            renderTasks(); renderDashboard();
        }
        function toggleTask(id) {
            let t=tasks.find(t=>t.id==id);
            t.done=!t.done;
            localStorage.setItem("aw_tasks",JSON.stringify(tasks));
            renderTasks(); renderDashboard();
        }
        // ------ Ø§Ù„Ø¥Ø­ØµØ§Ø¡Ø§Øª ------
        function renderDashboard() {
            document.getElementById("statProjects").textContent=projects.length;
            document.getElementById("statTasks").textContent=tasks.length;
            document.getElementById("statDone").textContent=tasks.filter(t=>t.done).length;
            let ctx=document.getElementById("chartTasks").getContext('2d');
            if(window.tasksChart) window.tasksChart.destroy();
            window.tasksChart=new Chart(ctx,{
                type:"doughnut",
                data:{
                    labels:["ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©","Ù…ÙƒØªÙ…Ù„Ø©"],
                    datasets:[{
                        data:[tasks.length-tasks.filter(t=>t.done).length,tasks.filter(t=>t.done).length],
                        backgroundColor:["#764ba2","#48bb78"]
                    }]
                },
                options:{responsive:true,plugins:{legend:{position:"bottom"}}}
            });
        }
        // ------ Ø§Ù„ØªÙ‚ÙˆÙŠÙ… ------
        let calDate=new Date();
        function moveMonth(val){
            calDate.setMonth(calDate.getMonth()+val);
            renderCalendar();
        }
        function renderCalendar(){
            let d=new Date(calDate);
            d.setDate(1);
            let month=d.getMonth();
            let year=d.getFullYear();
            document.getElementById("calendarMonthYear").textContent = `${year} - ${month+1}`;
            let days=[];
            for(let i=0;i<d.getDay();i++) days.push(""); // Ø§Ù„ÙØ±Ø§ØºØ§Øª Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø´Ù‡Ø±
            let lastDay=new Date(year,month+1,0).getDate();
            for(let i=1;i<=lastDay;i++) days.push(i);
            let today=new Date(); let tDay=today.getDate(),tMonth=today.getMonth(),tYear=today.getFullYear();
            let html="";
            days.forEach(val=>{
                let isToday=val==tDay && month==tMonth && year==tYear;
                let dayTasks=tasks.filter(t=>t.date==`${year}-${String(month+1).padStart(2,'0')}-${String(val).padStart(2,'0')}`);
                html+=`<div class="day-cell${isToday?' today':''}" onclick="showTasksForDay('${year}-${String(month+1).padStart(2,'0')}-${String(val).padStart(2,'0')}')">${val}${dayTasks.length?' <span style="color:#f56565">â—</span>':''}</div>`
            });
            document.getElementById("calendarDays").innerHTML=html;
            document.getElementById("calendarDayTasks").innerHTML="";
        }
        function showTasksForDay(date){
            let dayTasks=tasks.filter(t=>t.date==date);
            let list=document.getElementById("calendarDayTasks");
            if(!dayTasks.length) {list.innerHTML="<li>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ….</li>"; return;}
            list.innerHTML=dayTasks.map(t=>`<li>${t.text} (${projects.find(p=>p.id==t.projectId)?.name||""})</li>`).join("");
        }
        // ------ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª ------
        function addNotePrompt(){
            let title=prompt("Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©ØŸ"); if(!title) return;
            let text=prompt("Ø§Ù„Ù…Ø­ØªÙˆÙ‰ØŸ");
            let id=Date.now(); notes.push({id,title,text,date:new Date().toISOString().slice(0,16)});
            localStorage.setItem("aw_notes",JSON.stringify(notes));
            renderNotes();
        }
        function renderNotes(){
            let grid=document.getElementById("noteGrid");
            if(!notes.length){grid.innerHTML="<p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª.</p>";return;}
            grid.innerHTML=notes.map(n=>`
                <div class="note-card">
                  <div class="note-title">${n.title}</div>
                  <div style="color:#666">${n.text}</div>
                  <div style="font-size:0.85em;color:#988;margin-top:7px">ØªØ§Ø±ÙŠØ®: ${n.date}</div>
                  <button onclick="delNote(${n.id})" style="color:#c66;margin-top:5px">Ø­Ø°Ù</button>
                </div>
            `).join("");
        }
        function delNote(id){
            if(!confirm("Ø­Ø°Ù Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©ØŸ"))return;
            notes=notes.filter(n=>n.id!=id);
            localStorage.setItem("aw_notes",JSON.stringify(notes));
            renderNotes();
        }
// ØªØ­Ù…ÙŠÙ„ Ø£ÙˆÙ„ÙŠ Ù„Ù„Ø£Ù‚Ø³Ø§Ù… Ø¨Ø¹Ø¯ ÙØªØ­ Ø§Ù„ØµÙØ­Ø©
renderDashboard();
renderProjects();
renderTasks();
renderCalendar();
renderNotes();
