<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AliW | Ù‚Ø§Ø¦Ù…Ø© Ù…Ù‡Ø§Ù…ÙŠ (Google Tasks)</title>
  <link href="https://fonts.googleapis.com/css?family=Tajawal:600,900&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
  <style>
:root {
  --bg-main: #f7f7fb;
  --bg-side: #fff;
  --bg-task: #fff;
  --txt-main: #22263f;
  --txt-sub: #8082a0;
  --accent: #1976d2;
  --card-space: #f5f6fa;
  --prio-high:#e53935; --prio-med:#fb8c00; --prio-low:#1e88e5;
  --project-colors: #1976d2,#e53935,#43b3fa,#fb8c00,#00b383,#7d21ce,#c62828,#388e3c,#8d8a2e,#fa45a7;
}
[data-theme="dark"] {
  --bg-main: #181922;
  --bg-side: #232435;
  --bg-task: #21212e;
  --txt-main: #fff;
  --txt-sub: #b0b5c9;
  --accent: #43b3fa;
  --card-space: #202030;
  --prio-high:#ef4444; --prio-med:#fbbf24; --prio-low:#42a5f5;
}
body {background: var(--bg-main); color: var(--txt-main); font-family:Tajawal,Arial,sans-serif;margin:0;transition:background .18s;}
.header-app{display:flex;align-items:center;justify-content:space-between;background:var(--bg-side);padding:22px 19px 13px 19px;font-weight:900;font-size:1.21em;border-bottom:1px solid #dde1e937;}
.theme-switch{font-size:1.18em;border:none;background:var(--card-space);padding:8px 15px;border-radius:10px;color:var(--accent);cursor:pointer;}
.layout-row{display: flex;}
.sidebar{width:220px;background:var(--bg-side);height:97vh;padding-top:24px;box-shadow: -1px 0 14px #022a1a13;display:flex;flex-direction:column;gap:20px;align-items:flex-start;padding-right:11px;}
.logo{font-weight:900;color:var(--accent);font-size:1.21em;margin-bottom:27px;}
.menu-nav{display:flex;flex-direction:column;gap:10px;width:96%;}
.menu-head{color:var(--txt-sub);font-size:1.02em;font-weight:bold;padding:3px 0 5px 0;}
.archive-btn{background:var(--accent);color:#fff;border:none;padding:6px 17px 5px 17px;border-radius:8px;font-size:.96em;margin-bottom:8px;cursor:pointer;}
.list-group{margin:0;padding:0;list-style:none;}
.list-group li{padding:9px 8px;margin:3px 0;background:transparent;border-radius:8px;color:var(--txt-main);font-size:1.09em;cursor:pointer;display:flex;align-items:center;}
.list-group li.active,.list-group li:hover{background:var(--card-space);color:var(--accent);}
.project-dot{display:inline-block;width:13px;height:13px;border-radius:6px;margin-left:10px;}
.btn-add-list{background:var(--accent);color:#fff;border:none;padding:3.5px 12px 3.5px 11px;border-radius:7px;cursor:pointer;margin:5px 0;font-size:.98em;}
.main-content{flex:1;padding:44px 6vw 51px 6vw;}
.section-title{font-family:inherit;color:var(--accent);font-weight:900;margin:0 0 18px 0;font-size:1.33em;}
.tasks-panel{background:var(--bg-task);border-radius:21px;box-shadow:0 2px 14px #23395b18;padding:0 0 24px 0;max-width:550px;margin:auto;}
.tasks-header{display:flex;flex-direction:column;gap:7px;align-items:flex-end;justify-content:space-between;padding:20px 22px 9px 12px;}
.tasks-header-row{display:flex;align-items:center;gap:8px;width:100%;justify-content:space-between;}
.tasks-header .title{font-size:1.22em;font-weight:900;}
.tasks-header .btn-add-task{background:var(--accent);color:#fff;padding:6px 14px;border:none;border-radius:9px;cursor:pointer;}
.add-task-form{display:flex;gap:7px;width:100%;margin-top:5px;}
.add-task-form select,.add-task-form input{padding:7px 6px;border-radius:7px;border:1.2px solid #d7d7e7;font-size:1em;}
.add-task-form input[type="date"]{min-width:93px;}
.add-task-form button{background:var(--accent);color:#fff;border:none;border-radius:8px;padding:8px 16px;cursor:pointer;}
.add-task-form button:hover{background:#114385;}
.tasks-list{padding:0 21px;}
.task-row{display:flex;align-items:flex-start;gap:13px;padding:18px 0 14px 0;border-bottom:1px solid #e6e7e999;}
.task-row:last-child{border-bottom:none;}
.task-check{width:25px;height:25px;background:#fff;border-radius:50%;border:1.3px solid #adc2ee;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:.13s;}
[data-theme="dark"] .task-check{background:var(--card-space);}
.task-check.checked{background:var(--accent);border-color:var(--accent);}
.task-check .material-icons{font-size:1.21em;}
.task-info{flex:1;}
.task-title{font-size:1.11em;font-weight:900;margin-bottom:4px;word-break:break-word;}
.task-title.done{text-decoration:line-through;color:#7d839c;}
.task-meta{color:var(--txt-sub);font-size:.98em;display:flex;gap:6px;align-items:center;}
.task-prio{border-radius:10px;padding:2px 11px 0 11px;font-size:.97em;margin-left:9px;}
.task-prio.high{background:var(--prio-high);color:#fff;}
.task-prio.med{background:var(--prio-med);color:#fff;}
.task-prio.low{background:var(--prio-low);color:#fff;}
.task-proj-label{display:inline-block;font-size:.92em;font-weight:800;padding:0 7px 0 7px;border-radius:8px;margin-left:5px;}
.task-actions{margin-top:4px;}
.task-actions button{background:#f2f4f7;color:var(--accent);border:none;padding:2.5px 12px 2.5px 12px;border-radius:9px;cursor:pointer;font-size:.95em;margin-left:4px;}
.task-actions button.del{color:var(--prio-high);}
.task-actions button:active{background:var(--accent);color:#fff;}
.archive-section{padding:25px 0 0 0;}
.archive-title{font-size:1.13em;color:var(--accent);font-weight:900;margin-bottom:13px;padding-bottom:4px;border-bottom:1.5px solid #e4e4f0;}
.archive-list{background:var(--bg-task);border-radius:18px;box-shadow:0 2px 10px #22338a12;padding:13px 24px;max-width:500px;margin:auto;}
.archive-row{opacity:.74;}
.archive-row .task-title{color:#aaa;}
.archive-actions{margin-top:5px;}
::-webkit-scrollbar{height:8px;width:6px;background:var(--bg-side);}
::-webkit-scrollbar-thumb{background:var(--accent);border-radius:6px;}
@media(max-width:800px){.layout-row{flex-direction:column;}.sidebar{width:100vw;height:auto;flex-direction:row;padding:9px 0 0 0;}
.menu-nav{flex-direction:row;gap:14px;}.logo{margin-bottom:0;}

.tasks-panel{max-width:99vw;}
.archive-list{max-width:93vw;}
}
@media(max-width:580px){.main-content{padding:7px 0 7px 0;} .tasks-panel{border-radius:0;box-shadow:none;}}
  </style>
</head>
<body data-theme="light">
<div class="header-app">
  <span>AliW | Ù‚Ø§Ø¦Ù…Ø© Ù…Ù‡Ø§Ù…ÙŠ Ø¨Ø£Ø³Ù„ÙˆØ¨ Google Tasks</span>
  <button class="theme-switch" onclick="toggleTheme()" id="themeToggle">ğŸŒ™</button>
</div>
<div class="layout-row">
  <div class="sidebar">
    <div class="logo">AliW</div>
    <div class="menu-nav">
      <div class="menu-head">Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</div>
      <ul class="list-group" id="projList"></ul>
      <form onsubmit="addProject();return false;" style="display:flex;gap:4px;">
        <input type="text" id="newProjTitle" placeholder="Ù‚Ø§Ø¦Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©" maxlength="18" style="width:90px;">
        <button class="btn-add-list" type="submit">+</button>
      </form>
      <button class="archive-btn" onclick="showArchive()">Ø§Ù„Ø£Ø±Ø´ÙŠÙ</button>
    </div>
  </div>
  <div class="main-content">
    <div class="section-title">Ù…Ù‡Ø§Ù…ÙŠ (Google Tasks)</div>
    <div class="tasks-panel">
      <div class="tasks-header">
        <div class="tasks-header-row">
          <div class="title" id="currentProjectTitle">Ø§Ù„Ù…Ù‡Ø§Ù…</div>
          <button class="btn-add-task" onclick="openAddRow()">Ù…Ù‡Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
        </div>
        <form class="add-task-form" id="addTaskForm" onsubmit="addTask();return false;" style="display:none"></form>
      </div>
      <div class="tasks-list" id="tasksList"></div>
    </div>
    <div class="archive-section" id="archiveSection" style="display:none">
      <div class="archive-title">Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…Ù†Ø¬Ø²Ø© (Ø§Ù„Ø£Ø±Ø´ÙŠÙ)
        <button onclick="closeArchive()" style="float:left;background:var(--accent);color:white;border:0;padding:4px 15px 4px 15px;border-radius:7px;cursor:pointer;font-size:.97em;">Ø¥ØºÙ„Ø§Ù‚</button>
      </div>
      <div class="archive-list" id="archiveList"></div>
    </div>
  </div>
</div>
<script>
/* Ø£Ù„ÙˆØ§Ù† Ù…Ø´Ø§Ø±ÙŠØ¹ */
const projColors = (getComputedStyle(document.documentElement).getPropertyValue('--project-colors')||'').split(',');
let projects = JSON.parse(localStorage.getItem("projTasks_projects")||'[]');
let tasks = JSON.parse(localStorage.getItem("projTasks_tasks")||'[]');
let selectedProj = projects[0]?.id || null;
function saveProjects(){localStorage.setItem("projTasks_projects",JSON.stringify(projects));}
function saveTasks(){localStorage.setItem("projTasks_tasks",JSON.stringify(tasks));}
function projColor(id){
  let idx = projects.findIndex(x=>x.id==id);
  return projColors[ idx % projColors.length ];
}
function renderProjects(){
  let ul=document.getElementById("projList");
  if(!projects.length){
    projects=[{id:Date.now(),title:"Ù…Ù‡Ø§Ù…ÙŠ",def:true}];
    saveProjects();selectedProj = projects[0].id;
  }
  ul.innerHTML = projects.map(p=>
    `<li ${p.id==selectedProj?'class="active"':''} onclick="selectProj(${p.id})">
      <span class="project-dot" style="background:${projColor(p.id)}"></span>
      ${p.title}${!p.def?`<button onclick="event.stopPropagation();delProject(${p.id})" style="color:#e53935;background:transparent;border:none;cursor:pointer;font-size:1em;margin-right:5px;">Ã—</button>`:""}
    </li>`
    ).join('');
}
function selectProj(id){selectedProj=id;renderProjects();renderTaskList();}
function addProject(){
  let t=document.getElementById("newProjTitle").value.trim();
  if(!t)return;
  projects.push({id:Date.now(),title:t,def:false});
  saveProjects();
  document.getElementById("newProjTitle").value="";
  selectProj(projects[projects.length-1].id);
}
function delProject(id){
  if(!confirm("Ø­Ø°Ù Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©ØŸ")) return;
  projects=projects.filter(p=>p.id!=id);
  tasks=tasks.filter(tsk=>tsk.projId!=id);
  saveProjects();saveTasks();
  selectedProj=projects[0]?.id||null;
  renderProjects();renderTaskList();
}
/* ----------------- Ø§Ù„Ù…Ù‡Ø§Ù… ------------------- */
function projLabel(id){
  let proj=projects.find(x=>x.id==id);if(!proj)return '';
  return `<span class="task-proj-label" style="background:${projColor(id)};color:#fff">${proj.title}</span>`;
}
function renderTaskList(){
  document.getElementById("archiveSection").style.display="none";
  let list=document.getElementById("tasksList");
  let proj=projects.find(p=>p.id==selectedProj);
  document.getElementById("currentProjectTitle").textContent=(proj?.title)||"";
  let filtered=tasks.filter(t=>t.projId==selectedProj&&!t.done);
  // ØªØ±ØªÙŠØ¨: Ø§Ù„Ù…Ø¬Ø¯ÙˆÙ„Ø© Ø§Ù„Ø£Ø¹Ù„Ù‰ØŒ Ø«Ù… ØºÙŠØ± Ø§Ù„Ù…Ø¬Ø¯ÙˆÙ„Ø©
  let today=new Date().toISOString().slice(0,10)
  let scheduled=filtered.filter(t=>t.due).sort((a,b)=>a.due.localeCompare(b.due));
  let unscheduled=filtered.filter(t=>!t.due);
  let all=scheduled.concat(unscheduled);
  if(!all.length) {list.innerHTML ='<div style="color:var(--txt-sub);padding:30px 0;text-align:center">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù…</div>'; return;}
  list.innerHTML=all.map((t,i)=>{
    let idx=tasks.indexOf(t);
    return `<div class="task-row">
      <div class="task-check${t.done?' checked':''}" onclick="toggleDone(${idx})"><span class="material-icons">${t.done?'check':'radio_button_unchecked'}</span></div>
      <div class="task-info">
        <div class="task-title${t.done?' done':''}">${t.title} ${projLabel(t.projId)}</div>
        <div class="task-meta">
          ${t.due?`<span><span class="material-icons" style="font-size:1em;vertical-align:middle">event</span> ${t.due}</span>`:""}
          ${t.repeat&&!t.done?`<span><span class="material-icons" style="font-size:1em;vertical-align:middle">repeat</span> ${repeatLabel(t.repeat)}</span>`:""}
          <span class="task-prio ${t.prio}">${prioLabel(t.prio)}</span>
        </div>
        <div class="task-actions">
          <button onclick="editTask(${idx})">ØªØ¹Ø¯ÙŠÙ„</button>
          <button onclick="delTask(${idx})" class="del">Ø­Ø°Ù</button>
        </div>
      </div>
    </div>`
  }).join('');
}
function openAddRow(){
  let form=document.getElementById("addTaskForm");
  form.innerHTML=`
    <select id="addProjId">
      ${projects.map(p=>`<option value="${p.id}" ${p.id==selectedProj?'selected':''} style="background:${projColor(p.id)};color:#fff">${p.title}</option>`).join('')}
    </select>
    <input type="text" id="taskInput" placeholder="Ù†Øµ Ø§Ù„Ù…Ù‡Ù…Ø©..." maxlength="88" required>
    <input type="date" id="taskDue">
    <select id="taskPrio">
      <option value="high">Ø£ÙˆÙ„ÙˆÙŠØ© Ø¹Ø§Ù„ÙŠØ©</option>
      <option value="med" selected>Ù…ØªÙˆØ³Ø·Ø©</option>
      <option value="low">Ù…Ù†Ø®ÙØ¶Ø©</option>
    </select>
    <select id="taskRepeat">
      <option value="">ØªÙƒØ±Ø§Ø±</option>
      <option value="day">ÙŠÙˆÙ…ÙŠ</option>
      <option value="week">Ø£Ø³Ø¨ÙˆØ¹ÙŠ</option>
      <option value="month">Ø´Ù‡Ø±ÙŠ</option>
      <option value="year">Ø³Ù†ÙˆÙŠ</option>
    </select>
    <button>Ø¥Ø¶Ø§ÙØ©</button>
    <button type="button" onclick="closeAddRow()" style="background:#eee;color:#555;border:1px solid #eee">Ø¥Ù„ØºØ§Ø¡</button>
  `;
  form.style.display="flex";
  document.getElementById("taskInput").focus();
}
function closeAddRow(){
  document.getElementById("addTaskForm").style.display="none";
}
function addTask(){
  let title=document.getElementById("taskInput").value.trim();
  let prio=document.getElementById("taskPrio").value;
  let due=document.getElementById("taskDue").value;
  let repeat=document.getElementById("taskRepeat").value;
  let projId=parseInt(document.getElementById("addProjId").value);
  if(!title)return;
  tasks.push({id:Date.now(),projId,title,done:false,prio,due,repeat});
  saveTasks();
  closeAddRow();
  renderTaskList();
}
function editTask(i){
  let t=tasks[i];
  let newTitle=prompt("ØªØ¹Ø¯ÙŠÙ„ Ù†Øµ Ø§Ù„Ù…Ù‡Ù…Ø©:",t.title);
  if(newTitle!=null&&newTitle.trim()){
    t.title=newTitle.trim();
    saveTasks();
    renderTaskList();
  }
}
function delTask(i){
  if(!confirm("Ø­Ø°Ù Ø§Ù„Ù…Ù‡Ù…Ø©ØŸ"))return;
  tasks.splice(i,1);
  saveTasks();
  renderTaskList();
}
// Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¥Ù†Ø¬Ø§Ø²: ØªÙ†ØªÙ‚Ù„ Ù„Ù„Ø£Ø±Ø´ÙŠÙ ÙˆØªØ®ØªÙÙŠ
function toggleDone(i){
  tasks[i].done=!tasks[i].done;
  saveTasks();
  renderTaskList();
}
// ----------- Ø§Ù„Ø£Ø±Ø´ÙŠÙ -------------
function showArchive(){
  document.getElementById("archiveSection").style.display="block";
  let arch=tasks.filter(t=>t.done);
  let arcCont=document.getElementById("archiveList");
  if(!arch.length){
    arcCont.innerHTML='<div style="color:var(--txt-sub);padding:20px 0;text-align:center">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ù…Ù†Ø¬Ø²Ø©</div>';return;
  }
  arcCont.innerHTML=arch.map((t,i)=>{
    let idx=tasks.indexOf(t);
    return `<div class="task-row archive-row">
      <div class="task-info">
        <div class="task-title done">${t.title} ${projLabel(t.projId)}</div>
        <div class="task-meta">
          ${t.due?`<span><span class="material-icons" style="font-size:1em;vertical-align:middle">event</span> ${t.due}</span>`:""}
          ${t.repeat?`<span><span class="material-icons" style="font-size:1em;vertical-align:middle">repeat</span> ${repeatLabel(t.repeat)}</span>`:""}
          <span class="task-prio ${t.prio}">${prioLabel(t.prio)}</span>
        </div>
        <div class="archive-actions">
          <button onclick="unarchiveTask(${idx})" style="background:var(--accent);color:#fff;padding:3px 11px 3px 11px;border:0;border-radius:7px;">Ø§Ø³ØªØ±Ø¬Ø§Ø¹</button>
          <button onclick="delTask(${idx})" class="del" style="margin-left:7px;">Ø­Ø°Ù Ù†Ù‡Ø§Ø¦ÙŠ</button>
        </div>
      </div>
    </div>`
  }).join('');
}
function closeArchive(){
  document.getElementById("archiveSection").style.display="none";
  renderTaskList();
}
function unarchiveTask(i){
  tasks[i].done=false;
  saveTasks();
  showArchive();
}
function prioLabel(p){
  if(p=="high")return"Ù‡Ø§Ù…";
  if(p=="med")return"Ù…ØªÙˆØ³Ø·";
  return"Ù…Ù†Ø®ÙØ¶";
}
function repeatLabel(r){
  if(r=="day")return"ÙŠÙˆÙ…ÙŠ";
  if(r=="week")return"Ø£Ø³Ø¨ÙˆØ¹ÙŠ";
  if(r=="month")return"Ø´Ù‡Ø±ÙŠ";
  if(r=="year")return"Ø³Ù†ÙˆÙŠ";
  return "";
}
function toggleTheme(){
  let th=document.body.dataset.theme=="light"?"dark":"light";
  document.body.dataset.theme=th;
  document.getElementById("themeToggle").textContent=th=="dark"?"â˜€ï¸":"ğŸŒ™";
  localStorage.setItem("theme_mode",th);
}
document.body.dataset.theme = localStorage.getItem("theme_mode")||"light";
document.getElementById("themeToggle").textContent = document.body.dataset.theme=="dark"?"â˜€ï¸":"ğŸŒ™";
if(!projects.length){projects=[{id:Date.now(),title:"Ù…Ù‡Ø§Ù…ÙŠ",def:true}];saveProjects();}
if(!selectedProj)selectedProj=projects[0].id;
renderProjects();selectProj(selectedProj);
</script>
</body>
</html>
