<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ali Workspace - Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø´Ø§Ù…Ù„</title>
    <link href="https://fonts.googleapis.com/css?family=Tajawal:500,700,900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            margin:0; padding:0; min-height: 100vh;
            font-family:'Tajawal',sans-serif;
            background:#f8fafc;
        }
        .sidebar {
            position:fixed;right:0;top:0;width:75px;height:100vh;background:#23395b;z-index:100;display:flex;flex-direction:column;align-items:center;
        }
        .logo {margin:32px auto 28px auto;font-size:1.3em;font-weight:900;color:#fff;letter-spacing:.5px;}
        .menu-item {width:99%;padding:25px 0;margin:7px 0;border-radius:17px;display:flex;justify-content:center;align-items:center;cursor:pointer;color:#cad6e8;font-size:1.45em;transition:.13s;}
        .menu-item.active, .menu-item:hover{background:#132443;color:#fff;}
        .main-content {margin-right:80px;padding:40px 7vw 70px 7vw;max-width:1100px;}
        .section {display:none;}
        .section.active{display:block;}
        .header {font-size:2.05em; font-weight:900; color:#23395b;margin-bottom:33px;letter-spacing:.5px;}
        /* Flat Cards/Buttons */
        .stat-row {display:flex;gap:2.5vw;}
        .stat-card {flex:1;background:#fff;border-radius:22px;box-shadow:0 2px 24px #23395b0f;padding:32px 0;text-align:center;min-width:155px;}
        .stat-title{font-size:1.09em;color:#8590a2;}
        .stat-val {font-size:2.6em;color:#23395b;font-weight:900;}
        /* Flat input/modal */
        .modal-bg {position:fixed;top:0;right:0;left:0;bottom:0;background:rgba(70,40,90,.09);z-index:999;}
        .modal-box {position:fixed;top:50%;right:50%;transform:translate(50%,-50%);background:#fff;padding:35px 22px 26px 22px;border-radius:22px;box-shadow:0 22px 50px #23395b14;z-index:1000;width:370px;max-width:98vw;}
        .modal-box label {font-weight:700;margin:7px 0 0 0;display:inline-block;}
        .modal-box input, .modal-box textarea, .modal-box select {font-size:1em;padding:8px 7px;margin:8px 0 15px 0;border-radius:11px;border:1.3px solid #e8eaf1;width:97.5%;}
        .modal-btn-bar{display:flex;justify-content:right;gap:11px;margin-top:13px;}
        .add-fab {position:fixed;bottom:28px;left:6vw;width:61px;height:61px;background:#23395b;color:#fff;display:flex;align-items:center;justify-content:center;font-size:2.3em;
            border:none;border-radius:50%;box-shadow:0 6px 22px #23395b44;cursor:pointer;z-index:700;transition:box-shadow .2s;}
        .add-fab:hover {box-shadow:0 14px 42px #23395b77;}
        /* Flat Project Cards */
        .proj-list{display:flex;flex-wrap:wrap;gap:23px;}
        .proj-card{background:#fff;border-radius:19px;box-shadow:0 2px 16px #23395b13;padding:30px 34px 22px 20px;flex:1 1 290px; min-width:230px;}
        .proj-title{font-weight:800;font-size:1.14em;color:#243b5e;}
        .proj-info{color:#6d7790;font-size:.98em;margin-bottom:8px;}
        .proj-actions{margin-top:7px;}
        .btn{background:#23395b;padding:0 22px;height:34px;border-radius:11px;border:none;color:#fff;cursor:pointer;font-weight:700;letter-spacing:.1px;margin-left:7px;}
        .btn.sec{background:#eaeef3;color:#23395b;}
        /* Tasks */
        .task-list{display:flex;flex-direction:column;gap:23px;}
        .task-card{background:#fff;border-radius:19px;box-shadow:0 2px 16px #23395b10;padding:25px 27px 12px 20px;}
        .task-head{display:flex;align-items:center;justify-content:space-between}
        .task-proj-label{background:#23395b;color:#fff;border-radius:9px;padding:4px 12px;font-size:.92em;}
        .task-title{font-weight:800;font-size:1.14em;margin:5px 0 2px 0;}
        .task-desc{color:#6d7690;margin-bottom:8px;}
        .task-meta{font-size:.97em;color:#aab;}
        .note-li{background:#f4f5f7;border-radius:11px;padding:5px 11px;margin:2px 0 4px 0;color:#625b69;font-size:.98em;}
        .note-li small{color:#caa;margin-left:12px;}
        /* Flat UI */
        .input-row{margin-bottom:13px;}
        .note-card{background:#fff;border-radius:17px;box-shadow:0 2px 12px #23395b19;padding:19px;margin-bottom:15px;}
        .note-title{font-weight:800;margin-bottom:7px;color:#23395b;}
        .empty-txt{text-align:center;color:#b9b1da;font-size:1.11em;padding:4px;}
        /* Responsive */
        @media (max-width:900px){
            .main-content{padding:20px 2vw 60px 2vw;}
            .proj-list,.task-list{gap:10px;}
        }
        @media (max-width:650px){
            .main-content{margin:0!important;padding:9px 0 45px 0;}
            .sidebar{top:auto;bottom:0;right:0;left:0;width:100vw;height: 65px;flex-direction:row;gap:15px;}
            .logo{display:none;}
            .menu-item{padding:10px 0;margin:0;border-radius:12px;font-size:1.06em;}
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="logo">AliW</div>
        <div class="menu-item active" onclick="showSection('dashboard')">ğŸ“Š</div>
        <div class="menu-item" onclick="showSection('projects')">ğŸ“</div>
        <div class="menu-item" onclick="showSection('tasks')">âœ…</div>
        <div class="menu-item" onclick="showSection('calendar')">ğŸ“…</div>
        <div class="menu-item" onclick="showSection('notes')">ğŸ“</div>
    </div>
    <div class="main-content">
        <!-- Dashboard -->
        <div id="dashboard" class="section active">
            <div class="header">Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¡Ø§Øª</div>
            <div class="stat-row">
                <div class="stat-card"><div class="stat-title">Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</div><div class="stat-val" id="statProjects">0</div></div>
                <div class="stat-card"><div class="stat-title">Ø§Ù„Ù…Ù‡Ø§Ù…</div><div class="stat-val" id="statTasks">0</div></div>
                <div class="stat-card"><div class="stat-title">Ø§Ù„Ù…ÙƒØªÙ…Ù„Ø©</div><div class="stat-val" id="statDone">0</div></div>
            </div>
        </div>
        <!-- Projects -->
        <div id="projects" class="section">
            <div class="header">Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</div>
            <div style="margin-bottom:19px;"><button class="btn" onclick="openProjectModal()">+ Ù…Ø´Ø±ÙˆØ¹ Ø¬Ø¯ÙŠØ¯</button></div>
            <div class="proj-list" id="projList"></div>
        </div>
        <!-- Tasks -->
        <div id="tasks" class="section">
            <div class="header">Ø§Ù„Ù…Ù‡Ø§Ù…</div>
            <div style="margin-bottom:19px;"><button class="btn" onclick="openTaskModal()">+ Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø©</button></div>
            <div class="task-list" id="taskList"></div>
        </div>
        <!-- Calendar -->
        <div id="calendar" class="section">
            <div class="header">Ø§Ù„ØªÙ‚ÙˆÙŠÙ…</div>
            <!-- Ø¨Ø¥Ù…ÙƒØ§Ù†Ùƒ ÙˆØ¶Ø¹ ÙƒÙˆØ¯ Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ù…Ø±Ø¦ÙŠ Ù‡Ù†Ø§ Ø£Ùˆ Ø³ÙƒØ±ÙŠØ¨Øª -->
            <div style="text-align:center;color:#799;">(Ù…ÙŠØ²Ø© Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±...)</div>
        </div>
        <!-- Notes -->
        <div id="notes" class="section">
            <div class="header">Ø¯ÙØªØ± Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</div>
            <div style="margin-bottom:19px;"><button class="btn" onclick="openNoteModal()">+ Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ø§Ø­Ø¸Ø©</button></div>
            <div id="noteGrid"></div>
        </div>
    </div>
    <!-- Ø²Ø± Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³Ø±ÙŠØ¹ Ù„Ù„Ø¬ÙˆØ§Ù„ -->
    <button class="add-fab" id="addFab" title="Ø¥Ø¶Ø§ÙØ© Ø¬Ø¯ÙŠØ¯">ï¼‹</button>
    <script>
    // Ø¨ÙŠØ§Ù†Ø§Øª Ø±Ø¦ÙŠØ³ÙŠØ©
    let projects = JSON.parse(localStorage.getItem("aw_projects")||"[]");
    let tasks = JSON.parse(localStorage.getItem("aw_tasks")||"[]");
    let notes = JSON.parse(localStorage.getItem("aw_notes")||"[]");
    let selectedProj = projects.length ? projects[0].id : null;
    function showSection(sec){
       document.querySelectorAll('.menu-item').forEach((e,i)=>{
         e.classList.toggle('active',["dashboard","projects","tasks","calendar","notes"].indexOf(sec)===i)
       });
       document.querySelectorAll('.section').forEach(e=>e.classList.remove('active'));
       document.getElementById(sec).classList.add('active');
       if(sec==="dashboard")renderDashboard();
       if(sec==="projects")renderProjects();
       if(sec==="tasks")renderTasks();
       if(sec==="notes")renderNotes();
       document.getElementById('addFab').style.display=(sec==="notes"||sec==="tasks"||sec==="projects")?"block":"none";
    }
    // Dashboard
    function renderDashboard(){
      document.getElementById("statProjects").textContent=projects.length;
      document.getElementById("statTasks").textContent=tasks.length;
      document.getElementById("statDone").textContent=tasks.filter(t=>t.done).length;
    }
    // Projects & Modal
    function renderProjects(){
      let grid=document.getElementById("projList");
      if(!projects.length){grid.innerHTML="<p class='empty-txt'>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø´Ø§Ø±ÙŠØ¹.</p>";return;}
      grid.innerHTML=projects.map(p=>`
        <div class="proj-card">
            <div class="proj-title">${p.name}</div>
            <div class="proj-info">${p.desc||""}&nbsp;</div>
            <div style="margin-bottom:5px;font-size:.97em;color:#23395b">${tasks.filter(t=>t.projectId==p.id).length} Ù…Ù‡Ø§Ù…</div>
            <div class="proj-actions">
                <button class="btn sec" onclick="editProjectPrompt(${p.id})">ØªØ­Ø±ÙŠØ±</button>
                <button class="btn" style="background:#e33a4a;" onclick="delProject(${p.id})">Ø­Ø°Ù</button>
            </div>
        </div>
      `).join("");
    }
    // Tasks & Modal
    function renderTasks(){
      let grid=document.getElementById("taskList");
      if(!tasks.length){grid.innerHTML="<p class='empty-txt'>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù….</p>";return;}
      grid.innerHTML=tasks.map(t=>{
        let proj=projects.find(p=>p.id==t.projectId);
        return `<div class="task-card">
            <div class="task-head">
                <span class="task-proj-label" style="background:${proj?.color||'#23395b'}">${proj?.name||""}</span>
                <span>
                   <button class="btn sec" onclick="toggleTask(${t.id})">${t.done?'â':'âœ”ï¸'}</button>
                   <button class="btn" style="background:#e33a4a;" onclick="delTask(${t.id})">Ø­Ø°Ù</button>
                </span>
            </div>
            <div class="task-title">${t.name}</div>
            <div class="task-desc">${t.desc||""}</div>
            <div class="task-meta">${t.date?`ğŸ“… ${t.date}`:""} ${t.repeat&&t.repeat!='Ø¨Ø¯ÙˆÙ†'?`| âŸ³ ${t.repeat}`:''}
            ${t.attach?`| <a href="${t.attach}" style="color:#23395b;text-decoration:underline;" target="_blank">Ø§Ù„Ù…Ø±ÙÙ‚</a>`:""}</div>
            <ul style="margin:6px 0 0 0;padding:0;list-style:none;">
              ${(t.notes||[]).map(n=>`<li class="note-li">${n.text}<small>${n.date}</small></li>`).join("")}
            </ul>
        </div>`;
      }).join("");
    }
    // Notes
    function renderNotes(){
      let grid=document.getElementById("noteGrid");
      if(!notes.length){grid.innerHTML="<p class='empty-txt'>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª.</p>";return;}
      grid.innerHTML=notes.map(n=>`
        <div class="note-card">
          <div class="note-title">${n.title}</div>
          <div style="color:#555;font-size:1em;">${n.text}</div>
          <div style="font-size:0.91em;color:#bbb;margin-top:5px">ØªØ§Ø±ÙŠØ®: ${n.date}</div>
          <button class="btn sec" style="margin-top:8px" onclick="delNote(${n.id})">Ø­Ø°Ù</button>
        </div>
      `).join("");
    }
    // -------- Modals ---------
    let tempNotes=[];
    document.getElementById("addFab").onclick = function(){
        let s = document.querySelector('.section.active').id;
        if(s==="projects") openProjectModal();
        if(s==="tasks") openTaskModal();
        if(s==="notes") openNoteModal();
    };
    function openProjectModal(proj){
        let bg=document.createElement('div');
        bg.className='modal-bg';
        let modal=document.createElement('div');
        modal.className='modal-box';
        modal.innerHTML=`
            <div style="font-size:1.19em;font-weight:800;margin-bottom:11px">${proj?'ØªØ¹Ø¯ÙŠÙ„':'Ø¥Ø¶Ø§ÙØ©'} Ù…Ø´Ø±ÙˆØ¹</div>
            <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</label> <input id="pName" value="${proj?.name||''}" maxlength="28"/>
            <label>Ø§Ù„ÙˆØµÙ</label> <input id="pDesc" value="${proj?.desc||''}"/>
            <label>Ù„ÙˆÙ† Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</label> <input id="pColor" value="${proj?.color||'#23395b'}" type="color" style="width:70px"/>
            <div class="modal-btn-bar">
              <button onclick="${proj?'saveProjEdit('+proj.id+')':'saveProjAdd()'}" class="btn">Ø­ÙØ¸</button>
              <button onclick="closeModal()" class="btn sec">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        `;
        document.body.append(bg,modal); window.closeModal=()=>{modal.remove();bg.remove();}
    }
    function saveProjAdd(){
        let name=document.getElementById("pName").value.trim();
        if(!name)return alert("Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø¥Ø¬Ø¨Ø§Ø±ÙŠ");
        let desc=document.getElementById("pDesc").value.trim();
        let color=document.getElementById("pColor").value;
        let id=Date.now();
        projects.push({id,name,desc,color});
        localStorage.setItem("aw_projects",JSON.stringify(projects));
        renderProjects();renderDashboard();
        closeModal();
    }
    function editProjectPrompt(id){openProjectModal(projects.find(p=>p.id==id));}
    function saveProjEdit(id){
        let name=document.getElementById("pName").value.trim();
        if(!name)return alert("Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø¥Ø¬Ø¨Ø§Ø±ÙŠ");
        let desc=document.getElementById("pDesc").value.trim();
        let color=document.getElementById("pColor").value;
        let i=projects.findIndex(p=>p.id==id);
        projects[i]={...projects[i],name,desc,color};
        localStorage.setItem("aw_projects",JSON.stringify(projects));
        renderProjects();renderDashboard();closeModal();
    }
    function delProject(id){
        if(!confirm("Ø­Ø°Ù Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ØŸ"))return;
        projects=projects.filter(p=>p.id!=id);
        tasks=tasks.filter(t=>t.projectId!=id);
        localStorage.setItem("aw_projects",JSON.stringify(projects));
        localStorage.setItem("aw_tasks",JSON.stringify(tasks));
        renderProjects();renderTasks();renderDashboard();
    }
    function openTaskModal(){
        tempNotes=[];
        let bg=document.createElement('div');
        bg.className='modal-bg';
        let modal=document.createElement('div');
        modal.className='modal-box';
        modal.innerHTML=`
            <div style="font-size:1.18em;font-weight:800;margin-bottom:15px">Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø©</div>
            <label>Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</label>
            <select id="taskProj">${projects.map(p=>`<option value="${p.id}" style="background:${p.color}">${p.name}</option>`)}</select>
            <label>Ø§Ø³Ù… Ø§Ù„Ù…Ù‡Ù…Ø©</label><input id="taskName" maxlength="38"/>
            <label>ÙˆØµÙ Ø§Ù„Ù…Ù‡Ù…Ø©</label><textarea id="taskDesc" rows="2"></textarea>
            <label>Ø§Ù„ØªØ§Ø±ÙŠØ®</label><input id="taskDate" type="date"/>
            <label>Ø§Ù„ØªÙƒØ±Ø§Ø±</label>
            <select id="taskRepeat">
                <option>Ø¨Ø¯ÙˆÙ†</option><option>ÙŠÙˆÙ…ÙŠ</option><option>Ø£Ø³Ø¨ÙˆØ¹ÙŠ</option><option>Ø´Ù‡Ø±ÙŠ</option>
            </select>
            <label>Ù…Ø±ÙÙ‚/Ø±Ø§Ø¨Ø·</label><input id="taskAttach" type="text" placeholder="Ø§Ù„ØµÙ‚ Ø±Ø§Ø¨Ø· Ø£Ùˆ ÙˆØµÙ Ù…Ø®ØªØµØ±" />
            <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù„Ù„Ù…Ù‡Ù…Ø© (Ø§Ø¶ØºØ· Enter Ù„Ù„ØªØ³Ø¬ÙŠÙ„)</label>
            <textarea id="taskNoteInput" rows="1" onkeyup="if(event.key=='Enter'){addTaskNote();}"></textarea>
            <ul id="taskNotesList" style="margin:0;list-style:none;padding:0;"></ul>
            <div class="modal-btn-bar">
              <button onclick="saveTaskAdd()" class="btn">Ø¥Ø¶Ø§ÙØ©</button>
              <button onclick="closeModal()" class="btn sec">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        `;
        document.body.append(bg,modal);window.closeModal=()=>{modal.remove();bg.remove();}
    }
    function addTaskNote(){
        let txt=document.getElementById('taskNoteInput').value.trim();
        if(!txt)return;
        let d=new Date();
        let now=d.toLocaleString('ar-SA',{weekday:"long",day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"});
        tempNotes.push({text:txt,date:now});
        renderTaskNotes();
        document.getElementById('taskNoteInput').value="";
    }
    function renderTaskNotes(){
        let lst=document.getElementById('taskNotesList');
        lst.innerHTML=tempNotes.map(n=>`<li class="note-li">
          <span>${n.text}</span>
          <small>${n.date}</small>
        </li>`).join('');
    }
    function saveTaskAdd(){
        let pId = +document.getElementById("taskProj").value;
        let name = document.getElementById("taskName").value.trim();
        let desc = document.getElementById("taskDesc").value.trim();
        let date = document.getElementById("taskDate").value;
        let repeat = document.getElementById("taskRepeat").value;
        let attach = document.getElementById("taskAttach").value.trim();
        if(!name)return alert("Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ù‡Ù…Ø©");
        let id=Date.now();
        let notes=tempNotes.slice();
        tasks.push({id,projectId:pId,name,desc,date,repeat,attach,notes,done:false});
        localStorage.setItem("aw_tasks",JSON.stringify(tasks));
        tempNotes=[];
        renderTasks();renderDashboard();
        closeModal();
    }
    function delTask(id){
        if(!confirm("Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù…Ù‡Ù…Ø©ØŸ")) return;
        tasks=tasks.filter(t=>t.id!=id);localStorage.setItem("aw_tasks",JSON.stringify(tasks));
        renderTasks(); renderDashboard();
    }
    function toggleTask(id){
        let t=tasks.find(t=>t.id==id);
        t.done=!t.done;
        localStorage.setItem("aw_tasks",JSON.stringify(tasks));
        renderTasks(); renderDashboard();
    }
    function openNoteModal(){
        let bg=document.createElement('div');
        bg.className='modal-bg';
        let modal=document.createElement('div');
        modal.className='modal-box';
        modal.innerHTML=`
            <div style="font-size:1.19em;font-weight:800;margin-bottom:11px">Ø¥Ø¶Ø§ÙØ© Ù…Ù„Ø§Ø­Ø¸Ø©</div>
            <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©</label><input id="noteTitle"/><br>
            <label>Ø§Ù„Ù…Ø­ØªÙˆÙ‰</label><textarea id="noteText" rows="3"></textarea>
            <div class="modal-btn-bar">
            <button onclick="saveNoteAdd()" class="btn">Ø¥Ø¶Ø§ÙØ©</button>
            <button onclick="closeModal()" class="btn sec">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
        `;
        document.body.append(bg,modal);window.closeModal=()=>{modal.remove();bg.remove();}
    }
    function saveNoteAdd(){
        let title=document.getElementById("noteTitle").value.trim();
        if(!title)return alert("Ø§Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©");
        let text=document.getElementById("noteText").value.trim();
        let id=Date.now(); notes.push({id,title,text,date:new Date().toISOString().slice(0,16)});
        localStorage.setItem("aw_notes",JSON.stringify(notes));
        renderNotes(); closeModal();
    }
    function delNote(id){
        if(!confirm("Ø­Ø°Ù Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©ØŸ"))return;
        notes=notes.filter(n=>n.id!=id);
        localStorage.setItem("aw_notes",JSON.stringify(notes));
        renderNotes();
    }
    // Ù„Ø£ÙˆÙ„ ØªØ­Ù…ÙŠÙ„
    window.onload=()=>{
      renderDashboard();
      renderProjects();
      renderTasks();
      renderNotes();
    }
    </script>
</body>
</html>
