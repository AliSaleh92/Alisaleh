<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù†Ø¸Ø§Ù… Ù…Ù‡Ø§Ù… Ø¨ØªØµÙ…ÙŠÙ… Google Calendar - Ø¯Ø§ÙƒÙ†/ÙØ§ØªØ­</title>
  <link href="https://fonts.googleapis.com/css?family=Tajawal:500,700,900&display=swap" rel="stylesheet">
  <style>
:root {
  --bg-main: #f6f7fb;
  --bg-side: #fff;
  --bg-card: #fff;
  --txt-main: #191b1f;
  --txt-sub: #676a7c;
  --accent: #2563eb;
  --kanban-back: #edf2fa;
  --border-card: #e7eaf2;
  --button-bg: #2563eb;
  --button-txt: #fff;
  --priority-high: #ef4444;
  --priority-med: #f59e42;
  --priority-low: #60a5fa;
}

[data-theme="dark"] {
  --bg-main: #22232a;
  --bg-side: #181a20;
  --bg-card: #26272c;
  --txt-main: #fff;
  --txt-sub: #b4b6be;
  --accent: #40a9ff;
  --kanban-back: #282a36;
  --border-card: #40424d;
  --button-bg: #2563eb;
  --button-txt: #fff;
  --priority-high: #ef4444;
  --priority-med: #fbbf24;
  --priority-low: #60a5fa;
}
body {
  background: var(--bg-main);
  color: var(--txt-main);
  font-family: "Tajawal", Arial, sans-serif;
  margin: 0;
  transition: background .2s;
}
.header-app {
  background: var(--bg-side);
  color: var(--txt-main);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 19px 30px 14px 30px;
  border-bottom: 1.4px solid var(--border-card);
  position: sticky;
  top: 0;
  z-index: 20;
}
.header-app h1 {
  font-weight: 900;
  font-size: 1.54em;
  margin: 0;
  letter-spacing: 0.08em;
}
.theme-switch {
  border: none;
  border-radius: 8px;
  background: var(--kanban-back);
  font-size: 1.33em;
  padding: 6px 17px;
  color: var(--accent);
  margin-right: 8px;
  cursor: pointer;
  transition: background .2s;
}
.sidebar {
  position: fixed;
  top: 0;
  right: 0;
  width: 70px;
  height: 100vh;
  background: var(--bg-side);
  display: flex;
  flex-direction: column;
  align-items: center;
  box-shadow: -2px 0 14px #0001;
  z-index: 100;
  transition: background .2s;
}
.sidebar .logo {
  font-weight: bold;
  color: var(--accent);
  font-size: 1.9em;
  margin: 19px auto 32px auto;
}
.menu-nav {
  display: flex;
  flex-direction: column;
  gap: 18px;
  width: 100%;
  margin-top: 7vh;
}
.menu-item {
  color: var(--txt-sub);
  text-align: center;
  padding: 16px 0;
  border-radius: 13px;
  font-size: 1.48em;
  margin: 0 5px;
  cursor: pointer;
}
.menu-item.active, .menu-item:hover {
  background: var(--accent);
  color: #fff;
}
.main-content {
  margin-right: 90px;
  padding:40px 4vw 70px 4vw;
  min-height:90vh;
  max-width:1200px;
}
.kanban-board {
  display: flex;
  gap: 2vw;
  justify-content: flex-start;
  align-items: flex-start;
  margin-top:30px
}
.kanban-col {
  flex: 1;
  min-width: 210px;
  background: var(--kanban-back);
  border-radius: 15px;
  padding: 14px 6px 32px 6px;
  box-shadow: 0 2px 18px #1e212a08;
  display: flex;
  flex-direction: column;
  gap: 17px;
  border: 1.3px solid var(--border-card);
  min-height: 450px;
}
.kanban-title {
  text-align: center;
  font-weight: bold;
  color: var(--accent);
  padding: 7px 0 12px 0;
  letter-spacing:.04em;
}
.kanban-tasks {
  min-height: 30px;
}
.kanban-task {
  background: var(--bg-card);
  color: var(--txt-main);
  border-radius: 12px;
  box-shadow: 0 2px 9px #22242f08;
  padding: 15px 14px 10px 14px;
  border: 1px solid var(--border-card);
  margin-bottom:3px;
  cursor: move;
  position:relative;
  transition: background .15s;
  display:flex;flex-direction:column;gap:4px
}
.kanban-task[draggable="true"] {opacity:.96;}
.kb-title-row{display:flex;align-items:center;gap:5px}
.kb-task-prio{
  border-radius:60px;
  color:#fff;
  padding:2.7px 13px 2.7px 12px;
  font-size:.98em;
  font-weight:bold;
  letter-spacing:.02em;
  margin-left:7px
}
.kb-task-prio.high{background:var(--priority-high);}
.kb-task-prio.med{background:var(--priority-med);}
.kb-task-prio.low{background:var(--priority-low);}
.kb-desc{color:var(--txt-sub);font-size:.97em;padding-bottom:2px;}
.kb-date{color:var(--accent);font-size:.96em}
.kanban-add {margin: 0 auto 0 auto;display:flex;gap:3px;}
.kanban-add input, .kanban-add select {padding:6px;font-size:1em;border-radius:8px;border:1.2px solid var(--border-card);}
.kanban-add button {background:var(--button-bg);color:var(--button-txt);padding:7px 14px;border-radius:8px;border:none;cursor:pointer;}
@media (max-width: 800px){.main-content{padding:20px 2vw}}
@media (max-width: 650px){.sidebar{position:static;width:100vw;height:60px;flex-direction:row;padding:0 11vw}
.logo{display:none}.main-content{margin:0 !important;}}
  </style>
</head>
<body data-theme="light">
  <div class="header-app">
    <h1>Ù…Ø³Ø§Ø­Ø© Ø¥Ø¯Ø§Ø±Ø© Ù…Ù‡Ø§Ù…ÙŠ</h1>
    <button class="theme-switch" onclick="toggleTheme()" id="themeToggle">ğŸŒ™</button>
  </div>
  <div class="sidebar">
    <div class="logo">AliW</div>
    <div class="menu-nav">
      <div class="menu-item active">ğŸ“… Ø§Ù„Ù…Ù‡Ø§Ù… (ÙƒØ§Ù†Ø¨Ø§Ù†)</div>
      <div class="menu-item">ğŸ“ Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</div>
      <div class="menu-item">ğŸ“ Ù…Ù„Ø§Ø­Ø¸Ø§Øª</div>
      <div class="menu-item">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</div>
    </div>
  </div>
  <div class="main-content">
    <div style="font-size:1.09em;color:var(--txt-sub);margin-bottom:13px;">
      Ù„ÙˆØ­Ø© ÙƒØ§Ù†Ø¨Ø§Ù† Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù‡Ø§Ù… ÙˆØ§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª Ø¨Ù†Ù…Ø· Google Calendar
    </div>
    <div class="kanban-board" id="kanbanBoard"></div>
    <div class="kanban-add">
      <input type="text" id="taskTitle" placeholder="... Ù†Øµ Ø§Ù„Ù…Ù‡Ù…Ø©" maxlength="100">
      <select id="taskPrio">
        <option value="high">Ø¹Ø§Ù„ÙŠØ©</option>
        <option value="med" selected>Ù…ØªÙˆØ³Ø·Ø©</option>
        <option value="low">Ù…Ù†Ø®ÙØ¶Ø©</option>
      </select>
      <button onclick="addTask()">Ø¥Ø¶Ø§ÙØ©</button>
    </div>
    <div style="margin-top:20px;">
      <button onclick="exportTasks()" class="theme-switch">ØªØµØ¯ÙŠØ±</button>
      <input type="file" style="display:none;" id="importInput" accept=".json" onchange="importTasksFile(event)">
      <button onclick="document.getElementById('importInput').click()" class="theme-switch">Ø§Ø³ØªÙŠØ±Ø§Ø¯</button>
    </div>
  </div>
  <script>
const taskStates=["new","progress","done","hold","cancel"];
const stateLabels={
  "new":"Ø¬Ø¯ÙŠØ¯",
  "progress":"Ù‚ÙŠØ¯ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²",
  "done":"Ù…ÙƒØªÙ…Ù„Ø©",
  "hold":"Ù…Ø¹Ù„Ù‚Ø©",
  "cancel":"Ù…Ù„ØºØ§Ø©"
};
const prioLabels={high:"Ø¹Ø§Ù„ÙŠØ©",med:"Ù…ØªÙˆØ³Ø·Ø©",low:"Ù…Ù†Ø®ÙØ¶Ø©"};
const prioClasses={high:"high",med:"med",low:"low"};
let tasks = JSON.parse(localStorage.getItem("kanban_tasks")||"[]");
// ØªÙ…ÙƒÙŠÙ† Ø§Ù„Ø¯Ø§Ø±Ùƒ/Ø§Ù„Ù„Ø§ÙŠØª ÙˆØ§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±
if(localStorage.getItem("theme_mode")){
  document.body.dataset.theme = localStorage.getItem("theme_mode");
  document.getElementById("themeToggle").textContent=
    document.body.dataset.theme=="dark"?"â˜€ï¸":"ğŸŒ™";
}
function toggleTheme(){
  let th=document.body.dataset.theme=="light"?"dark":"light";
  document.body.dataset.theme=th;
  document.getElementById("themeToggle").textContent=th=="dark"?"â˜€ï¸":"ğŸŒ™";
  localStorage.setItem("theme_mode",th);
}
// Ø±Ø³Ù… ÙƒØ§Ù†Ø¨Ø§Ù†
function renderKanban() {
  let board = document.getElementById("kanbanBoard");
  board.innerHTML = "";
  taskStates.forEach(state=>{
    let col=document.createElement("div");
    col.className="kanban-col";
    col.dataset.state=state;
    col.innerHTML = `<div class="kanban-title">${stateLabels[state]}</div>
      <div class="kanban-tasks" id="tasks-${state}" ondrop="drop(event,'${state}')" ondragover="allowDrop(event)"></div>`;
    board.appendChild(col);
  });
  tasks.forEach((t,i)=>{
    let card=document.createElement("div");
    card.className="kanban-task";
    card.draggable=true;
    card.ondragstart=function(e){e.dataTransfer.setData("task-index",i);};
    card.innerHTML=`
      <div class="kb-title-row">
        <span class="kb-task-prio ${prioClasses[t.prio]}">${prioLabels[t.prio]}</span>
        <b>${t.title}</b>
      </div>
      <div class="kb-desc">${t.desc?t.desc:""}</div>
      <div class="kb-date">${t.date?t.date:""}</div>
      <div style="font-size:.93em;margin-top:6px">
        <button onclick="editTask(${i})" class="theme-switch" style="font-size:.93em">ğŸ–Šï¸</button>
        <button onclick="delTask(${i})" class="theme-switch" style="color:#ef4444;font-size:.93em">Ø­Ø°Ù</button>
      </div>
    `;
    document.getElementById("tasks-"+t.state).appendChild(card);
  });
}
// Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© Ø¬Ø¯ÙŠØ¯Ø©
function addTask(){
  let title=document.getElementById("taskTitle").value.trim();
  let prio=document.getElementById("taskPrio").value;
  if(!title) return alert("Ø±Ø¬Ø§Ø¡Ù‹ Ø£Ø¯Ø®Ù„ Ù†Øµ Ø§Ù„Ù…Ù‡Ù…Ø©");
  tasks.push({title,prio,state:"new",desc:"",date:new Date().toLocaleString("ar-EG")});
  localStorage.setItem("kanban_tasks",JSON.stringify(tasks));
  document.getElementById("taskTitle").value="";
  renderKanban();
}
// Ø­Ø°Ù Ù…Ù‡Ù…Ø©
function delTask(i){
  if(!confirm("Ø­Ø°Ù Ø§Ù„Ù…Ù‡Ù…Ø©ØŸ"))return;
  tasks.splice(i,1);
  localStorage.setItem("kanban_tasks",JSON.stringify(tasks));
  renderKanban();
}
// ØªØ­Ø±ÙŠØ±
function editTask(i){
  let t=tasks[i];
  let newTitle = prompt("Ø¹Ø¯Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‡Ù…Ø©",t.title);
  if(newTitle!=null&&newTitle.trim()){
    t.title=newTitle;
    localStorage.setItem("kanban_tasks",JSON.stringify(tasks));
    renderKanban();
  }
}
// Ø³Ø­Ø¨ Ø¥ÙÙ„Ø§Øª
function allowDrop(evt){evt.preventDefault();}
function drop(evt, newState){
  evt.preventDefault();
  let idx=+evt.dataTransfer.getData("task-index");
  tasks[idx].state=newState;
  localStorage.setItem("kanban_tasks",JSON.stringify(tasks));
  renderKanban();
}
// ØªØµØ¯ÙŠØ±/Ø§Ø³ØªÙŠØ±Ø§Ø¯
function exportTasks(){
  let data=JSON.stringify(tasks,null,2);
  let a=document.createElement("a");
  a.href="data:application/json,"+ encodeURIComponent(data);
  a.download="kanban_tasks.json";
  a.click();
}
function importTasksFile(e){
  let file = e.target.files[0];
  if(!file)return;
  let reader=new FileReader();
  reader.onload = function(evt){
    try{
      let arr=JSON.parse(evt.target.result);
      if(!Array.isArray(arr)||!arr[0].title)throw "Ù…Ù„Ù ØºÙŠØ± ØµØ­ÙŠØ­";
      tasks=arr;
      localStorage.setItem("kanban_tasks",JSON.stringify(tasks));
      renderKanban();
      alert("ØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ù…Ù‡Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­");
    }catch{alert("Ù…Ù„Ù ØºÙŠØ± ØµØ­ÙŠØ­ Ø£Ùˆ ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…");}
  };
  reader.readAsText(file);
}
// Ø±ÙŠÙ†Ø¯Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠ
window.onload=renderKanban;
  </script>
</body>
</html>
