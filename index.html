<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ù„ÙˆØ­Ø© ÙƒØ§Ù†Ø¨Ø§Ù† - Google Calendar Design</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Tajawal:500,700,900&display=swap">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <style>
:root {
  --bg-main: #f5f6fa;
  --bg-side: #fff;
  --bg-card: #fff;
  --txt-main: #181a20;
  --txt-sub: #789;
  --accent: #2563eb;
  --kanban-back: #eef1f4;
  --border-card: #e6e8ef;
  --button-bg: #2563eb;
  --button-txt: #fff;
  --priority-high: #ef4444;
  --priority-med: #f59e42;
  --priority-low: #60a5fa;
}
[data-theme="dark"] {
  --bg-main: #23232e;
  --bg-side: #1a1a25;
  --bg-card: #232432;
  --txt-main: #fff;
  --txt-sub: #b0b5c9;
  --accent: #46a6fa;
  --kanban-back: #282a36;
  --border-card: #353648;
  --button-bg: #2563eb;
  --button-txt: #fff;
}
body {
  background: var(--bg-main);
  color: var(--txt-main);
  font-family: "Tajawal", Arial, sans-serif;
  margin: 0;
  transition: background .2s;
}
.header-app{
  background:var(--bg-side);color:var(--txt-main);
  display:flex;align-items:center;justify-content:space-between;
  padding:20px 28px;border-bottom:1.3px solid var(--border-card);}
.header-app h1{font-size:1.45em;font-weight:900;margin:0;letter-spacing:.05em;}
.theme-switch{border:none;background:var(--kanban-back);font-size:1.3em;padding:6px 17px;color:var(--accent);
  border-radius:9px;cursor:pointer;transition:background .2s;}
.sidebar{
  position:fixed;top:0;right:0;width:65px;height:100vh;background:var(--bg-side);padding-top:14px;
  box-shadow:-1px 0 19px #22212514;display:flex;flex-direction:column;align-items:center;z-index:99;}
.logo{font-weight:900;color:var(--accent);font-size:1.4em;margin-bottom:43px;}
.menu-nav{display:flex;flex-direction:column;gap:15px;width:100%;}
.menu-item{color:var(--txt-sub);padding:15px 0;text-align:center;cursor:pointer;transition:.17s;font-size:1.57em;}
.menu-item.active,.menu-item:hover{background:var(--accent);color:#fff;}
.menu-icon{font-size:1.18em !important;}
.main-content{margin-right:80px;padding:35px 4vw 70px 4vw;max-width:1200px;}
.kanban-board{display:flex;gap:2vw;justify-content:flex-start;align-items:flex-start;margin-top:20px;overflow-x:auto;}
.kanban-col{flex:1;min-width:210px;background:var(--kanban-back);border-radius:14px;padding:12px 7px 32px 7px;box-shadow:0 2px 13px #1e212a08;display:flex;flex-direction:column;gap:11px;border:1.3px solid var(--border-card);min-height:390px;}
.kanban-title{text-align:center;font-weight:900;color:var(--accent);padding:5px 0 9px 0;letter-spacing:.01em;margin-bottom:7px;}
.kanban-tasks{min-height:25px;}
.kanban-task{background:var(--bg-card);color:var(--txt-main);border-radius:11px;box-shadow:0 2px 9px #22242f08;padding:13px 13px 8px 10px;border:1px solid var(--border-card);margin-bottom:3px;cursor:move;transition:background .15s;display:flex;flex-direction:column;gap:2px;}
.kanban-task[draggable="true"]{opacity:.96;}
.kb-title-row{display:flex;align-items:center;gap:5px}
.kb-task-prio{padding:2px 11px;border-radius:60px;color:#fff;font-size:.98em;font-weight:800;margin-left:8px}
.kb-task-prio.high{background:var(--priority-high);}
.kb-task-prio.med{background:var(--priority-med);}
.kb-task-prio.low{background:var(--priority-low);}
.kb-desc{color:var(--txt-sub);font-size:.98em;padding-bottom:1px;}
.kb-date{color:var(--accent);font-size:.94em;}
.kanban-add{display:flex;gap:5px;margin-top:30px;}
.kanban-add input,.kanban-add select{padding:7px 4px;font-size:1.06em;border-radius:8px;border:1.2px solid var(--border-card);}
.kanban-add button{background:var(--button-bg);color:var(--button-txt);padding:7px 16px;border-radius:8px;border:none;cursor:pointer;transition:background .17s;}
.kanban-add button:hover{background:#14369c;}
.kb-actions-row{display:flex;gap:2px;margin-top:5px;}
.kb-actions-row button{background:var(--kanban-back);color:var(--accent);border:none;border-radius:7px;padding:2px 10px;cursor:pointer;}
.kb-actions-row button.del{color:var(--priority-high);}
.kb-actions-row button:active{background:var(--accent);color:#fff;}
::-webkit-scrollbar{height:7px;width:5px;background:var(--bg-main);}
::-webkit-scrollbar-thumb{background:var(--accent);border-radius:7px;}
@media(max-width:800px){.main-content{padding:15px 2vw}}
@media(max-width:650px){
  .sidebar{position:fixed;width:100vw;height:65px;flex-direction:row;top:auto;bottom:0;left:0;right:0;}
  .main-content{margin:0 !important;padding:11px 0 70px 0;}
  .logo{display:none;}
}
  </style>
</head>
<body data-theme="light">
  <div class="header-app">
    <h1><span style="color:var(--accent)">AliW</span> | Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ù…Ù‡Ø§Ù…ÙŠ</h1>
    <button class="theme-switch" onclick="toggleTheme()" id="themeToggle">ğŸŒ™</button>
  </div>
  <div class="sidebar">
    <div class="logo">AliW</div>
    <div class="menu-nav">
      <div class="menu-item active"><span class="material-icons menu-icon">check_circle</span><div style="font-size:.72em;font-weight:bold">Ø§Ù„Ù…Ù‡Ø§Ù…<br>(ÙƒØ§Ù†Ø¨Ø§Ù†)</div></div>
      <div class="menu-item"><span class="material-icons menu-icon">folder_special</span><div style="font-size:.72em;">Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹</div></div>
      <div class="menu-item"><span class="material-icons menu-icon">sticky_note_2</span><div style="font-size:.72em;">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</div></div>
      <div class="menu-item"><span class="material-icons menu-icon">settings</span><div style="font-size:.72em;">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</div></div>
    </div>
  </div>
  <div class="main-content">
    <div style="font-size:1.07em;color:var(--txt-sub);margin-bottom:13px;">Ù„ÙˆØ­Ø© ÙƒØ§Ù†Ø¨Ø§Ù† Ø£Ù†ÙŠÙ‚Ø© - Google Calendar Style</div>
    <div class="kanban-board" id="kanbanBoard"></div>
    <form class="kanban-add" onsubmit="addTask();return false;">
      <input type="text" id="taskTitle" placeholder="... Ù†Øµ Ø§Ù„Ù…Ù‡Ù…Ø©" maxlength="100">
      <select id="taskPrio">
        <option value="high">Ø£ÙˆÙ„ÙˆÙŠØ© Ø¹Ø§Ù„ÙŠØ©</option>
        <option value="med" selected>Ù…ØªÙˆØ³Ø·Ø©</option>
        <option value="low">Ù…Ù†Ø®ÙØ¶Ø©</option>
      </select>
      <button type="submit">Ø¥Ø¶Ø§ÙØ©</button>
    </form>
    <div style="margin-top:23px;">
      <button onclick="exportTasks()" class="theme-switch">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©</button>
      <input type="file" style="display:none;" id="importInput" accept=".json" onchange="importTasksFile(event)">
      <button onclick="document.getElementById('importInput').click()" class="theme-switch">Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ù„Ù Ø¨ÙŠØ§Ù†Ø§Øª</button>
    </div>
  </div>
  <script>
const taskStates=["new","progress","done","hold","cancel"];
const stateLabels={
  "new":"Ø¬Ø¯ÙŠØ¯",
  "progress":"Ù‚ÙŠØ¯ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²",
  "done":"Ù…ÙƒØªÙ…Ù„Ø©",
  "hold":"Ù…Ø¹Ù„Ù‚Ø©",
  "cancel":"Ù…Ù„ØºØ§Ø©"
};
const prioLabels={high:"Ø¹Ø§Ù„ÙŠØ©",med:"Ù…ØªÙˆØ³Ø·Ø©",low:"Ù…Ù†Ø®ÙØ¶Ø©"};
const prioClasses={high:"high",med:"med",low:"low"};
let tasks = JSON.parse(localStorage.getItem("kanban_tasks")||"[]");
// ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø«ÙŠÙ… ÙˆÙ„Ø§ÙŠØª/Ø¯Ø§Ø±Ùƒ
if(localStorage.getItem("theme_mode")){
  document.body.dataset.theme = localStorage.getItem("theme_mode");
  document.getElementById("themeToggle").textContent=
    document.body.dataset.theme=="dark"?"â˜€ï¸":"ğŸŒ™";
}
function toggleTheme(){
  let th=document.body.dataset.theme=="light"?"dark":"light";
  document.body.dataset.theme=th;
  document.getElementById("themeToggle").textContent=th=="dark"?"â˜€ï¸":"ğŸŒ™";
  localStorage.setItem("theme_mode",th);
}
// ----------- Ø±Ø³Ù… Ù„ÙˆØ­Ø© Ø§Ù„ÙƒØ§Ù†Ø¨Ø§Ù† --------
function renderKanban() {
  let board = document.getElementById("kanbanBoard");
  board.innerHTML = "";
  taskStates.forEach(state=>{
    let col=document.createElement("div");
    col.className="kanban-col";
    col.dataset.state=state;
    col.innerHTML = `<div class="kanban-title">${stateLabels[state]}</div>
      <div class="kanban-tasks" id="tasks-${state}" ondrop="drop(event,'${state}')" ondragover="allowDrop(event)"></div>`;
    board.appendChild(col);
  });
  tasks.forEach((t,i)=>{
    let card=document.createElement("div");
    card.className="kanban-task";
    card.draggable=true;
    card.ondragstart=function(e){e.dataTransfer.setData("task-index",i);};
    card.innerHTML=`
      <div class="kb-title-row">
        <span class="kb-task-prio ${prioClasses[t.prio]}">${prioLabels[t.prio]}</span>
        <b>${t.title}</b>
      </div>
      <div class="kb-desc">${t.desc?t.desc:""}</div>
      <div class="kb-date">${t.date?t.date:""}</div>
      <div class="kb-actions-row">
        <button onclick="editTask(${i})" title="ØªØ¹Ø¯ÙŠÙ„"><span class="material-icons">edit</span></button>
        <button onclick="delTask(${i})" class="del" title="Ø­Ø°Ù"><span class="material-icons">delete</span></button>
      </div>
    `;
    document.getElementById("tasks-"+t.state).appendChild(card);
  });
}
// ----------- Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø© ---------
function addTask(){
  let title=document.getElementById("taskTitle").value.trim();
  let prio=document.getElementById("taskPrio").value;
  if(!title) return alert("Ø±Ø¬Ø§Ø¡Ù‹ Ø£Ø¯Ø®Ù„ Ù†Øµ Ø§Ù„Ù…Ù‡Ù…Ø©");
  tasks.push({title,prio,state:"new",desc:"",date:new Date().toLocaleString("ar-EG")});
  localStorage.setItem("kanban_tasks",JSON.stringify(tasks));
  document.getElementById("taskTitle").value="";
  renderKanban();
}
// Ø­Ø°Ù Ù…Ù‡Ù…Ø©
function delTask(i){
  if(!confirm("Ø­Ø°Ù Ø§Ù„Ù…Ù‡Ù…Ø©ØŸ"))return;
  tasks.splice(i,1);
  localStorage.setItem("kanban_tasks",JSON.stringify(tasks));
  renderKanban();
}
// ØªØ­Ø±ÙŠØ±
function editTask(i){
  let t=tasks[i];
  let newTitle = prompt("ØªØ¹Ø¯ÙŠÙ„ Ù†Øµ Ø§Ù„Ù…Ù‡Ù…Ø©",t.title);
  if(newTitle!=null&&newTitle.trim()){
    t.title=newTitle;
    localStorage.setItem("kanban_tasks",JSON.stringify(tasks));
    renderKanban();
  }
}
// Ø³Ø­Ø¨ Ø¥ÙÙ„Ø§Øª
function allowDrop(evt){evt.preventDefault();}
function drop(evt, newState){
  evt.preventDefault();
  let idx=+evt.dataTransfer.getData("task-index");
  tasks[idx].state=newState;
  localStorage.setItem("kanban_tasks",JSON.stringify(tasks));
  renderKanban();
}
// ØªØµØ¯ÙŠØ± ÙˆØ§Ø³ØªÙŠØ±Ø§Ø¯
function exportTasks(){
  let data=JSON.stringify(tasks,null,2);
  let a=document.createElement("a");
  a.href="data:application/json,"+ encodeURIComponent(data);
  a.download="kanban_tasks.json";
  a.click();
}
function importTasksFile(e){
  let file = e.target.files[0];
  if(!file)return;
  let reader=new FileReader();
  reader.onload = function(evt){
    try{
      let arr=JSON.parse(evt.target.result);
      if(!Array.isArray(arr)||!arr[0].title)throw "Ù…Ù„Ù ØºÙŠØ± ØµØ­ÙŠØ­";
      tasks=arr;
      localStorage.setItem("kanban_tasks",JSON.stringify(tasks));
      renderKanban();
      alert("ØªÙ… Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¨Ù†Ø¬Ø§Ø­!");
    }catch{alert("Ù…Ù„Ù ØºÙŠØ± ØµØ­ÙŠØ­ Ø£Ùˆ ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…");}
  };
  reader.readAsText(file);
}
// Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø³Ù… Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
window.onload=renderKanban;
  </script>
</body>
</html>
